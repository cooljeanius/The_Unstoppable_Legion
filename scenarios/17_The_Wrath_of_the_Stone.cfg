#textdomain wesnoth-The_Unstoppable_Legion
[scenario]
	id=The_Wrath_of_the_Stone

	name= _ "The Wrath of the Stone"
	next_scenario=The_Darkest_Day
        victory_when_enemies_defeated=no
	{UL_MAP The_Wrath_of_the_Stone}
	{DEEP_UNDERGROUND}
	{TURNS 18 18 18}

	[story]
	[part]
	music=underground.ogg
	story= _ "And so, at last, we were in the cave. Somewhere ahead, in the depths, lay the crystal we had to destroy in order to break Zharagorn's power once and for all. Our prospects looked good. We knew the same secret of Zharagorn's phantom guards as the Circle of Druids knew 700 years ago. It was a secret that got them killed, but Zharagorn must have truly feared what they knew in order to pursue them personally. We, on the other hand, had made it even further than the druids did, and Zharagorn didn't even know we were here. For a while, I felt we were home and dry."
	background=story/suveran.png
	[/part]
	[part]
	story= _ "But as we headed into the darkness, doubts began to grow. There was still things in Deuterus's final letter that didn't make sense. He said Zharagorn could not be defeated by anger or hatred, but I had what it takes - but what did he mean by that? Perhaps Eridith knew this part of the plan, but why had she not shared it with me? I could not get these thoughts out of my head."
	background=story/suveran.png
	[/part]
	[part]
	story= _ "We are now close to where the Black Emerald lies. The last time Deuterus kept a secret, it was that he was planning his own death. I do not know what he has planned this time. Perhaps the same fate must befall me too. If this is to be my last entry in this journal, then I hope my story can be brought back to Karasov, one day when this is all over."
	background=story/suveran.png
	[/part]
	[part]
            show_title=yes
		{TRAIL_TO_ALDANEN}
		{OLD_JOURNEY 264 122}
		{OLD_JOURNEY 264 101}
		{OLD_JOURNEY 270 86}
		{OLD_BATTLE 277 74}
		{NEW_JOURNEY 277 74}
		{NEW_JOURNEY 285 69}
		{NEW_BATTLE 292 65}
	background=story/suveran.png
        [/part]
	[/story]


# Viktor's Forces

[side]
	side=1
	controller=human
	team_name=Viktor

	type=Mounted Noble
	id=Viktor
	unrenamable=yes
	canrecruit=yes
	shroud=yes
	fog=yes

	recruit=UL_Dwarvish Fighter,UL_Dwarvish Thunderer,Dwarvish Guardsman

	{GOLD 350 300 250}
	{INCOME 2 1 0}
	
[/side]

# Baddies (all remain stored until goodies reach their section)

[side]
	side=2
	controller=ai
	team_name=Emerald

	type=Dark Marauder
	id=Arghan
	name= _ "Arghan"
	unrenamable=yes
	canrecruit=yes
	fog=yes

	recruit=Dark Fighter illusion,Dark Cultist illusion,Dark Adept illusion

	[ai]
		recruitment_ignore_bad_movement=yes
		recruitment_ignore_bad_combat=yes
		recruitment_pattern=fighter,fighter,scout,archer
		villages_per_scout=0
		passive_leader_shares_keep=yes
	[/ai]

	{GOLD 120 140 160}
	{INCOME 0 1 2}
[/side]
[side]
	side=3
	controller=ai
	team_name=Emerald

	type=Dark Warrior
	id=Dhawleesh
	name= _ "Dhawleesh"
	unrenamable=yes
	canrecruit=yes
	fog=yes

	recruit=Dark Fighter illusion,Dark Cultist illusion,Dark Adept illusion

	[ai]
		recruitment_ignore_bad_movement=yes
		recruitment_ignore_bad_combat=yes
		recruitment_pattern=fighter,fighter,scout,archer
		villages_per_scout=0
	[/ai]

	{GOLD 60 70 80}
	{INCOME 5 6 7}
[/side]
[side]
	side=4
	controller=ai
	team_name=Emerald

	type=Dark Sorcerer
	id=Verhahm
	name= _ "Verhahm"
	unrenamable=yes
	canrecruit=yes
	fog=yes

	recruit=Dark Fighter illusion,Dark Cultist illusion,Dark Adept illusion

	[ai]
		recruitment_ignore_bad_movement=yes
		recruitment_ignore_bad_combat=yes
		recruitment_pattern=fighter,fighter,scout,archer
		villages_per_scout=0
	[/ai]

	{GOLD 60 70 80}
	{INCOME 5 6 7}
[/side]

[side]
	side=5
	controller=ai
	team_name=Emerald

	type=Dark Warrior
	id=Vargon
	name= _ "Vargon"
	unrenamable=yes
	canrecruit=yes
	fog=yes

	recruit=Dark Fighter illusion,Dark Cultist illusion,Dark Adept illusion

	[ai]
		recruitment_ignore_bad_movement=yes
		recruitment_ignore_bad_combat=yes
		recruitment_pattern=fighter,fighter,scout,archer
		villages_per_scout=0
	[/ai]

	{GOLD 30 40 50}
	{INCOME 5 6 7}
[/side]
[side]
	side=6
	controller=ai
	team_name=Emerald

	type=Dark Marauder
	id=Flanghan
	name= _ "Flanghan"
	unrenamable=yes
	canrecruit=yes
	fog=yes

	recruit=Dark Fighter illusion,Dark Cultist illusion,Dark Adept illusion

	[ai]
		recruitment_ignore_bad_movement=yes
		recruitment_ignore_bad_combat=yes
		recruitment_pattern=fighter,fighter,scout,archer
		villages_per_scout=0
	[/ai]

	{GOLD 30 40 50}
	{INCOME 5 6 7}
[/side]
[side]
	side=7
	controller=ai
	team_name=Emerald

	type=Dark Sorcerer
	id=Jehsen
	name= _ "Jehsen"
	unrenamable=yes
	canrecruit=yes
	fog=yes

	recruit=Dark Fighter illusion,Dark Cultist illusion,Dark Adept illusion

	[ai]
		recruitment_ignore_bad_movement=yes
		recruitment_ignore_bad_combat=yes
		recruitment_pattern=fighter,fighter,scout,archer
		villages_per_scout=0
	[/ai]

	{GOLD 30 40 50}
	{INCOME 5 6 7}
[/side]

[side]
	side=8
	controller=ai
	team_name=Emerald

	no_leader=yes

	recruit=Dwarvish Fighter,Dwarvish Thunderguard,Dwarvish Guardsman

	[ai]
		recruitment_ignore_bad_movement=yes
		recruitment_ignore_bad_combat=yes
		recruitment_pattern=fighter,fighter,scout,archer
		villages_per_scout=0
	[/ai]

	{GOLD 200 250 300}
	{INCOME 0 1 2}
[/side]

[side]
	side=9
	controller=ai
	team_name=Emerald

	no_leader=yes

	[ai]

#All side 9 units go for Eridith

		[goal]
		    [criteria]
			id=Eridith
		    [/criteria]
		    value=1024
		[/goal]
	[/ai]

[/side]

#define RUNES X1 Y1 X2 Y2 X3 Y3

	[item]
		x={X1}
		y={Y1}
		image=scenery/rune1-glow.png
	[/item]

	[item]
		x={X2}
		y={Y2}
		image=scenery/rune2-glow.png
	[/item]

	[item]
		x={X3}
		y={Y3}
		image=scenery/rune3-glow.png
	[/item]
#enddef

#define RUNES-SPENT X1 Y1 X2 Y2 X3 Y3
 
	[remove_item]
		x={X1}
		y={Y1}
	[/remove_item]
	[remove_item]
		x={X2}
		y={Y2}
	[/remove_item]
	[remove_item]
		x={X3}
		y={Y3}
	[/remove_item]
	[item]
		x={X1}
		y={Y1}
		image=scenery/rune1.png
	[/item]
	[item]
		x={X2}
		y={Y2}
		image=scenery/rune2.png
	[/item]
	[item]
		x={X3}
		y={Y3}
		image=scenery/rune3.png
	[/item]
#enddef

[event]
	name=prestart

	[objectives]
		side=1
		victory_string= _ "Objective I:"
			[objective]
				description= _ "Advance into the cavern"
				condition=win
			[/objective]
			[objective]
				description= _ "Death of Viktor"
				condition=lose
			[/objective]
			[objective]
				description= _ "Death of Prince Sven"
				condition=lose
			[/objective]
			[objective]
				description= _ "Death of Eridith"
				condition=lose
			[/objective]
	            {TURNS_RUN_OUT}
		note = _ "In this scenario, turn limits will be extended as individual objectives are completed."
	[/objectives]

	[recall]
		id=Eridith
	[/recall]
	[recall]
		id=Golran
	[/recall]
	[recall]
		id=Halgar the Mighty
	[/recall]
	[recall]
		id=Captain Josephine
	[/recall]
	[recall]
		id=Prince Sven
	[/recall]

# Disallow horse recruits again, because for some reason they're popping back into the recruit list.

	[disallow_recruit]
		side=1
		type=UL_Cavalryman,Bowrider,UL_Horseman
	[/disallow_recruit]
	[set_recruit]
		side=1
		recruit=UL_Dwarvish Fighter,UL_Dwarvish Thunderer,Dwarvish Guardsman
	[/set_recruit]
	[disallow_extra_recruit]
		id=Viktor
		extra_recruit=UL_Cavalryman,Bowrider,UL_Horseman,UL_Cavalryman,Bowrider,UL_Horseman
	[/disallow_extra_recruit]

# Remove a random level 3 unit from the recall list (but not Halgar the Mighty).

	{RANDOM 1..4}

	[switch]
		variable=random
		[case]
			value=1
			[role]
				type=Dwarvish Dragonguard,Dwarvish Lord,Dwarwish Runemaster,Dwarvish Sentinel,Dwarvish Thunderguard,Dwarvish Flamethrower,Dwarvish Steelclad,Dwarwish Runesmith,Dwarvish Stalwart,UL_Dwarvish Thunderer,UL_Dwarvish Fighter,Dwarvish Guardsman
				[not]
				id=Halgar the Mighty
				[/not]
				role=chief_deserter
			[/role]
		[/case]
		[case]
			value=2
			[role]
				type=Dwarvish Lord,Dwarwish Runemaster,Dwarvish Sentinel,Dwarvish Dragonguard,Dwarvish Steelclad,Dwarwish Runesmith,Dwarvish Stalwart,Dwarvish Thunderguard,Dwarvish Flamethrower,UL_Dwarvish Fighter,Dwarvish Guardsman,UL_Dwarvish Thunderer
				[not]
				id=Halgar the Mighty
				[/not]
				role=chief_deserter
			[/role]
		[/case]
		[case]
			value=3
			[role]
				type=Dwarwish Runemaster,Dwarvish Lord,Dwarvish Dragonguard,Dwarwish Runesmith,Dwarvish Steelclad,Dwarvish Stalwart,Dwarvish Flamethrower,Dwarvish Sentinel,Dwarvish Thunderguard,UL_Dwarvish Fighter,Dwarvish Guardsman,UL_Dwarvish Thunderer
				[not]
				id=Halgar the Mighty
				[/not]
				role=chief_deserter
			[/role]
		[/case]
		[case]
			value=4
			[role]
				type=Dwarvish Sentinel,Dwarvish Dragonguard,Dwarvish Lord,Dwarwish Runemaster,Dwarvish Dwarvish Stalwart,Thunderguard,Dwarvish Flamethrower,Dwarvish Steelclad,Dwarwish Runesmith,UL_Dwarvish Thunderer,UL_Dwarvish Fighter,Dwarvish Guardsman
				[not]
				id=Halgar the Mighty
				[/not]
				role=chief_deserter
			[/role]
		[/case]
	[/switch]
	[store_unit]
		[filter]
			role=chief_deserter
		[/filter]
		variable=chief_deserter
		kill=yes
	[/store_unit]
	[set_variable]
		name=deserters
		value=1
	[/set_variable]

	{RUNES 4 13 5 13 6 12}

# Remove all baddies to allow appearances later

	[store_unit]
		[filter]
			id=Arghan
		[/filter]
		kill=yes
		variable=arghan
	[/store_unit]
	[store_unit]
		[filter]
			id=Dhawleesh
		[/filter]
		kill=yes
		variable=dhawleesh
	[/store_unit]
	[store_unit]
		[filter]
			id=Verhahm
		[/filter]
		kill=yes
		variable=verhahm
	[/store_unit]
	[store_unit]
		[filter]
			id=Vargon
		[/filter]
		kill=yes
		variable=vargon
	[/store_unit]
	[store_unit]
		[filter]
			id=Flanghan
		[/filter]
		kill=yes
		variable=flanghan
	[/store_unit]
	[store_unit]
		[filter]
			id=Jehsen
		[/filter]
		kill=yes
		variable=jehsen
	[/store_unit]

#define FOOTSTEPS X Y NAME
		[item]
			x={X}
			y={Y}
			image=footsteps/{NAME}
		[/item]
#enddef

		{FOOTSTEPS 8 15 foot-medium-out-s.png}
		{FOOTSTEPS 8 16 foot-normal-out-se.png}
		
		{FOOTSTEPS 11 19 foot-slow-in-ne.png}
		{FOOTSTEPS 12 21 foot-normal-in-se.png}
		{FOOTSTEPS 10 23 foot-medium-out-s.png}

		{FOOTSTEPS 18 18 foot-slow-in-se.png}
		{FOOTSTEPS 20 19 foot-normal-out-ne.png}
		{FOOTSTEPS 23 18 foot-normal-out-ne.png}
		{FOOTSTEPS 27 17 foot-medium-in-ne.png}
		{FOOTSTEPS 31 15 foot-normal-in-ne.png}
		{FOOTSTEPS 32 14 foot-slow-out-se.png}
		{FOOTSTEPS 36 14 foot-normal-out-se.png}
		{FOOTSTEPS 38 14 foot-normal-in-se.png}
		{FOOTSTEPS 43 17 foot-normal-in-s.png}
		{FOOTSTEPS 44 19 foot-medium-out-s.png}
		{FOOTSTEPS 45 24 foot-slow-in-se.png}
		{FOOTSTEPS 47 26 foot-normal-in-ne.png}
		{FOOTSTEPS 48 25 foot-medium-out-se.png}

		{FOOTSTEPS 19 22 foot-slow-in-se.png}
		{FOOTSTEPS 21 23 foot-normal-out-se.png}
		{FOOTSTEPS 23 24 foot-normal-out-se.png}
		{FOOTSTEPS 26 23 foot-medium-in-ne.png}
		{FOOTSTEPS 31 15 foot-normal-in-ne.png}
		{FOOTSTEPS 31 25 foot-slow-out-s.png}
		{FOOTSTEPS 30 27 foot-normal-out-s.png}
		{FOOTSTEPS 32 30 foot-normal-out-ne.png}
		{FOOTSTEPS 35 30 foot-normal-in-ne.png}
		{FOOTSTEPS 37 29 foot-medium-out-n.png}
		{FOOTSTEPS 39 27 foot-slow-in-se.png}
		{FOOTSTEPS 41 29 foot-normal-in-se.png}
		{FOOTSTEPS 44 29 foot-medium-out-se.png}
		{FOOTSTEPS 46 30 foot-medium-in-se.png}

		{FOOTSTEPS 12 28 foot-slow-in-se.png}
		{FOOTSTEPS 15 30 foot-normal-out-se.png}
		{FOOTSTEPS 16 31 foot-normal-out-se.png}
		{FOOTSTEPS 18 34 foot-medium-in-s.png}
		{FOOTSTEPS 20 37 foot-normal-out-s.png}
		{FOOTSTEPS 21 40 foot-slow-out-s.png}
		{FOOTSTEPS 24 42 foot-normal-out-s.png}
		{FOOTSTEPS 29 42 foot-normal-out-ne.png}
		{FOOTSTEPS 30 41 foot-normal-in-se.png}
		{FOOTSTEPS 35 40 foot-medium-out-ne.png}
		{FOOTSTEPS 33 39 foot-slow-in-ne.png}
		{FOOTSTEPS 41 37 foot-normal-in-ne.png}
		{FOOTSTEPS 44 35 foot-medium-out-ne.png}
		{FOOTSTEPS 47 35 foot-medium-in-n.png}

[/event]

[event]
	name=start

	[message]
		speaker=Golran
		message = _ "How long is this cave? It feels like we've been trekking forever."
	[/message]
	[message]
		speaker=Eridith
		message = _ "It's close. I can sense it! ... The Black Emerald is not far now."
	[/message]
	[message]
		speaker=Prince Sven
		message = _ "I can hear footsteps echoing through the cavern. Seems that's Zharagorn's forces are pursuing us."
	[/message]
	[message]
		speaker=Eridith
		message = _ "That is true. They're a long way off, but they'll catch up eventually. We must move before that happens."
	[/message]
	[message]
		speaker=Viktor
		message = _ "Will there be any more of those illusions down here?"
	[/message]
	[message]
		speaker=Eridith
		message = _ "Yes. I can sense the magic - but I'll still be able to dispel the apparitions."
	[/message]

	[message]
		speaker=Prince Sven
		message = _ "Is that it then? If you can get rid of the illusions like we did outside, there's nothing else to stop us, surely?"
	[/message]
	[message]
		speaker=Eridith
		message = _ "No ... It won't be that easy. There'll be something else to stop us."
	[/message]
	[message]
		speaker=Viktor
		message = _ "What like?"
	[/message]
	[message]
		speaker=Eridith
		message = _ "I don't know ... You must understand that we are not fighting Zharagorn now. We are fighting the power of the Black Emerald. An artefact this powerful will want to protect itself somehow. We've got to be prepared for anything."
	[/message]
	[message]
		speaker=Captain Josephine
		message = _ "I agree. There's no knowing what dark magic this powerful could throw at us."
	[/message]
	[message]
		speaker=Halger the Mighty
		message = _ "Whatever it is, I'm ready for them!"
	[/message]
	[set_variable]
		name=phase
		value=one
	[/set_variable]

[/event]

[event]
	name=recall
	[message]
		speaker=unit
		message = _ "Reporting for duty, sir!"
	[/message]
	[message]
		speaker=Prince Sven
		message = _ "Hey, where did $chief_deserter.name go?"
	[/message]
	[message]
		speaker=unit
		message = _ "$chief_deserter.name? That's funny, he was with me a moment ago. He can't have just disappeared!"
	[/message]
	[message]
		speaker=Eridith
		message = _ "I'm afraid he has just disappeared."
	[/message]
	[message]
		speaker=Viktor
		message = _ "Has the Black Emerald done this?"
	[/message]
	[message]
		speaker=Eridith
		message = _ "It would appear so."
	[/message]
	[message]
		speaker=Prince Sven
		message = _ "You mean my boys are going to keep vanishing? Is there nothing we can do to stop it?"
	[/message]
	[message]
		speaker=Eridith
		message = _ "I'm sorry, there isn't. We can only press on and hope it doesn't happen again."
	[/message]
[/event]

[event]
	name=moveto
	[filter]
		x=1-6
		y=9-13
	[/filter]
	[event]
		name=new turn
		[message]
			speaker=Prince Sven
			message = _ "What are those things?"
		[/message]
		[scroll_to]
			x=4
			y=13
		[/scroll_to]
		[message]
			speaker=Eridith
			message = _ "Hmm ...  interesting. They appear to be tri-lock runes."
		[/message]
		[message]
			speaker=Viktor
			message = _ "Tri-what runes?"
		[/message]
		[message]
			speaker=Eridith
			message = _ "Tri-lock runes. Always exist in threes. They are used to seal off portals."
		[/message]
		[message]
			speaker=unit
			message = _ "Well the way ahead seems to be a dead end, so that figures."
		[/message]
		[message]
			speaker=Prince Sven
			message = _ "I hope you know how to get past them."
		[/message]
		[message]
			speaker=Eridith
			message = _ "It's not too difficult. You need three rune-bearers to touch each of the three tri-lock runes together."
		[/message]
		[message]
			speaker=Viktor
			message = _ "And where do we get three rune-bearers?"
		[/message]
		[message]
			speaker=Eridith
			message = _ "It's a simple spell. Here it goes."
		[/message]
		[sound]
			name=magic-holy-1.ogg
		[/sound]
		[delay]
			time=1000
		[/delay]
		[sound]
			name=magic-holy-2.ogg
		[/sound]
		[delay]
			time=1000
		[/delay]
		[sound]
			name=magic-holy-3.ogg
		[/sound]
		[message]
			speaker=Eridith
			message = _ "There, it's done. I've made you, me and Prince Sven the runebearers."
		[/message]
		[message]
			speaker=Viktor
			message = _ "Why us three?"
		[/message]
		[message]
			speaker=Eridith
			message = _ "Because there's no knowing who else will disappear. If a rune-bearer disappears, we're sunk."
		[/message]
		[message]
			speaker=Prince Sven
			message = _ "How do you know one of us won't disappear?"
		[/message]
		[message]
			speaker=Eridith
			message = _ "I don't. All I know is if any of us disappear, we're doomed anyway."
		[/message]
		[message]
			speaker=Prince Sven
			message = _ "Great. Thanks for keeping the spirits up."
		[/message]
	[/event]
[/event]

[event]
	name=moveto
	first_time_only=no
	[filter]
		x=4,5,6
		y=13,13,12
	[/filter]
	[if]
		[and]
		[have_unit]
			id=Viktor
			x=4,5,6
			y=13,13,12
		[/have_unit]
		[have_unit]
			id=Prince Sven
			x=4,5,6
			y=13,13,12
		[/have_unit]
		[have_unit]
		id=Eridith
			x=4,5,6
			y=13,13,12
		[/have_unit]
		[variable]
			name=phase
			equals=one
		[/variable]
		[/and]
	[then]
		[message]
			speaker=Viktor
			message = _ "Okay, that's all three us ready. Let's do this."
		[/message]
		[message]
			speaker=Eridith
			message = _ "One moment, I need to check something."
		[/message]
		[message]
			speaker=Viktor
			message = _ "What is it?"
		[/message]
		[message]
			speaker=Eridith
			message = _ "How curious ... Power - fear - betrayal."
		[/message]
		[message]
			speaker=Viktor
			message = _ "Come again?"
		[/message]
		[message]
			speaker=Eridith
			message = _ "Power, fear, betrayal. These runes are symbols for power, fear and betrayal."
		[/message]
		[message]
			speaker=Viktor
			message = _ "What does that mean?"
		[/message]
		[message]
			speaker=Eridith
			message = _ "I honestly don't know. I'll have to think."
		[/message]
		[message]
			speaker=Prince Sven
			message = _ "Let's stick to the point. Can we open this portal or can't we?"
		[/message]
		[message]
			speaker=Eridith
			message = _ "Oh yes. We can still open the portal. On my count - one, two, three ..."
		[/message]
		[set_variable]
			name=phase
			value=two
		[/set_variable]
		{QUAKE "rumble.ogg"}
		{QUAKE "rumble.ogg"}
		{RUNES-SPENT 4 13 5 13 6 12}
		[terrain]
			x=5,6-7
			y=14-15,13-14
			terrain=Uu
		[/terrain]

		{RUNES 13 18 13 22 10 24}
		[unstore_unit]
			variable=arghan
		[/unstore_unit]
		[redraw]
			clear_shroud=yes
		[/redraw]
		[message]
			speaker=Arghan
			message = _ "Death to the intruders!"
		[/message]
		[message]
			speaker=Viktor
			message = _ "Look like the cave is guarded. To arms!"
		[/message]
		[music]
			name=into_the_shadows.ogg
			immediate=yes
		[/music]
		[music]
			name=undead.ogg
			append=yes
		[/music]
		[music]
			name=the_deep_path.ogg
			append=yes
		[/music]
		[music]
			name=knalgan_theme.ogg
			append=yes
		[/music]

	[/then]
	[/if]
[/event]

# Every turn, small chance that a non-hero/character unit will desert (only between openings of first and fourth portals). (Now excluding level 3 units too as further disappearing level 3s is too chancy. Let's assume that the level 3 units, once they are on their guard, are too strong-willed for the stone's corrupting influence.)

 [event]
 name=new turn
 first_time_only=no

[if]
	[variable]
		name=phase
		equals=two
	[/variable]
	[or]
	[variable]
		name=phase
		equals=three
	[/variable]
	[/or]
	[or]
	[variable]
		name=phase
		equals=four
	[/variable]
	[/or]
	[then]

	    [store_unit]
		[filter]
			type=Dwarvish Steelclad,Dwarwish Runesmith,Dwarvish Stalwart,Dwarvish Thunderguard,Dwarvish Flamethrower,UL_Dwarvish Fighter,Dwarvish Guardsman,UL_Dwarvish Thunderer
			[not]
			id=Halgar the Mighty
			[/not]
			[not]
			x,y=recall,recall
			[/not]
		[/filter]
		variable=desert_store
		kill=no
	    [/store_unit]

	    {FOREACH desert_store i}
	#ifdef EASY
			[set_variable]
				name=deserter
				rand=1..140
			[/set_variable]
	#endif
	#ifdef NORMAL
			[set_variable]
				name=deserter
				rand=1..120
			[/set_variable]
	#endif
	#ifdef HARD
			[set_variable]
				name=deserter
				rand=1..100
			[/set_variable]
	#endif
		[if]
			[variable]
				name=deserter
				equals=1
			[/variable]
			[then]
				[switch]
				variable=deserters
				    [case]
				       value=1
					[message]
						speaker=$desert_store[$i].id
						message = _ "The light ... I can see the light ..."
					[/message]
					[store_unit]
					    [filter]
						id=$desert_store[$i].id
					    [/filter]
					    variable=deserter2
					    kill=yes
						[/store_unit]
					[message]
						speaker=Prince Sven
						message = _ "Now $deserter2.name has disappeared too!"
					[/message]
					[message]
						speaker=Viktor
						message = _ "This is crazy! We can't defend ourselves if dwarves keep vanishing!"
					[/message]
					[message]
						speaker=Eridith
						message = _ "Viktor, there is nothing we can do to stop it. We can only try to reach the Emerald as quickly as possible and hope we don't lose anyone else."
					[/message]
					[set_variable]
						name=deserters
						value=2
					[/set_variable]
				    [/case]
				    [case]
				       value=2
					[message]
						speaker=$desert_store[$i].id
						message = _ "Wait ... I have a better idea."
					[/message]
					[store_unit]
					    [filter]
						id=$desert_store[$i].id
					    [/filter]
					    variable=deserter3
					    kill=yes
						[/store_unit]
					[message]
						speaker=Viktor
						message = _ "Oh no, now $deserter3.name has gone."
					[/message]
					[set_variable]
						name=deserters
						value=3
					[/set_variable]
				    [/case]
				    [case]
				       value=3
					[message]
						speaker=$desert_store[$i].id
						message = _ "So that's you reach the other side ..."
					[/message]
					[store_unit]
					    [filter]
						id=$desert_store[$i].id
					    [/filter]
					    variable=deserter4
					    kill=yes
						[/store_unit]
					[message]
						speaker=Eridith
						message = _ "Alas, we have lost $deserter4.name."
					[/message]
					[set_variable]
						name=deserters
						value=4
					[/set_variable]
				    [/case]
				    [case]
				       value=4
					[message]
						speaker=$desert_store[$i].id
						message = _ "At last ... now I see it so clearly ..."
					[/message]
					[store_unit]
					    [filter]
						id=$desert_store[$i].id
					    [/filter]
					    variable=deserter5
					    kill=yes
					[/store_unit]
					[message]
						speaker=Prince Sven
						message = _ "No, not $deserter5.name as well!"
					[/message]
					[set_variable]
						name=deserters
						value=5
					[/set_variable]
				    [/case]
				[/switch]
			[/then]
		[/if]

	    {NEXT i}
	    {CLEAR_VARIABLE desert_store}
	[/then]
[/if]

[/event]


[event]
	name=moveto
	[filter]
		x=4-9
		y=14-18
	[/filter]
	[event]
		name=new turn
		[message]
			speaker=Viktor
			message = _ "Wait a moment, what that?"
		[/message]
		[message]
			speaker=Prince Sven
			message = _ "Hmm ... interesting. Dwarven footsteps. Looks recent."
		[/message]
		[message]
			speaker=Golran
			message = _ "You know, now that you mention it, I can make out lots of tracks. That's quite a big army come this way."
		[/message]
		[message]
			speaker=Eridith
			message = _ "Dwarves? How strange."
		[/message]
		[message]
			speaker=Viktor
			message = _ "What would dwarves be doing down here?"
		[/message]
		[message]
			speaker=Prince Sven
			message = _ "More to the point, how did they get down here? Surely they couldn't have fought their way through the illusions?"
		[/message]
		[message]
			speaker=Viktor
			message = _ "Eridith, is there any possibility someone else could have known the secret to this cave?"
		[/message]
		[message]
			speaker=Eridith
			message = _ "I don't see how. It was the most closely guarded secret."
		[/message]
		[message]
			speaker=Prince Sven
			message = _ "Then how else could they have got past the guards?"
		[/message]
		[message]
			speaker=Eridith
			message = _ "All I can think is ... maybe the guards chose to let them in."
		[/message]
		[message]
			speaker=Prince Sven
			message = _ "Why would they do that?"
		[/message]
		[message]
			speaker=Eridith
			message = _ "I don't know ... but whatever the reason, it won't be a nice one."
		[/message]
			[event]
				name=new turn

				[message]
					speaker=Prince Sven
					message = _ "Is it just me, or has the mist still not gone away?"
				[/message]
				[message]
					speaker=Eridith
					message = _ "You are not imagaining things. This is no ordinary mist, it is a magical mist coming from the Black Emerald."
				[/message]
				[message]
					speaker=Viktor
					message = _ "We must be careful. It is blocking out so much light, this will surely work in the enemy's favour."
				[/message]

			[/event]
	[/event]
[/event]

# Whenever an illusion is recruited, 1/5 chance a real unit will be put in its place, and cost adjusted.

#define ILLUSION_CHECK TYPE GOLD_DIFFERENCE

[event]
name=recruit
first_time_only=no
	[filter]
		type={TYPE} illusion
	[/filter]
		[set_variable]
			name=illusion
			rand=1..5
		[/set_variable]

		[if]
			[variable]
				name=illusion
				equals=1
			[/variable]
			[then]
			[store_unit]
				[filter]
					x,y=$x1,$y1
				[/filter]
				kill=yes
				variable=real_unit
			[/store_unit]
			[set_variable]
				name=real_unit.type
				value={TYPE}
			[/set_variable]
			[unstore_unit]
				variable=real_unit
			[/unstore_unit]
			[gold]
			side=$real_unit.side
			amount=-{GOLD_DIFFERENCE}
			[/gold]
			[/then]		
		[/if]
[/event]

#enddef

{ILLUSION_CHECK (Dark Warrior) 24}
{ILLUSION_CHECK (Dark Headhunter) 12}
{ILLUSION_CHECK (Dark Fighter) 9}
{ILLUSION_CHECK (Dark Cultist) 7}
{ILLUSION_CHECK (Dark Adept) 11}

# Any illusion that engages in combat with Eridith is instantly dispelled. Real units fight as normal. Eridith gains 4XP for every illusion dispelled.

#define ERIDITH_XP

	[store_unit]
		[filter]
			id=Eridith
		[/filter]
		kill=yes
		variable=eridith
	[/store_unit]
	[set_variable]
		name=eridith.experience
		add=4
	[/set_variable]
	[unstore_unit]
		variable=eridith
	[/unstore_unit]


#enddef

#define DISPEL_ILLUSION TYPE

[event]
name=attack
first_time_only=no
	[filter]
		speaker=Eridith
	[/filter]
	[filter_second]
		type={TYPE} illusion
	[/filter_second]
	[message]
		speaker=Eridith
		message = _ "It's an illusion!"
	[/message]
	[kill]
		x,y=$x2,$y2
		animate=yes
		fire_event=yes
	[/kill]
	{ERIDITH_XP}
[/event]

[event]
name=attack
first_time_only=no
	[filter]
		speaker=Eridith
	[/filter]
	[filter_second]
		type={TYPE}
	[/filter_second]
	[message]
		speaker=Eridith
		message = _ "This one's real!"
	[/message]
[/event]

[event]
name=attack
first_time_only=no
	[filter]
		type={TYPE} illusion
	[/filter]
	[filter_second]
		speaker=Eridith
	[/filter_second]
	[message]
		speaker=Eridith
		message = _ "Begone, false trickery!"
	[/message]
	[kill]
		x,y=$x1,$y1
		animate=yes
		fire_event=yes
	[/kill]
	{ERIDITH_XP}
[/event]


[event]
name=attack
first_time_only=no
	[filter]
		type={TYPE}
	[/filter]
	[filter_second]
		speaker=Eridith
	[/filter_second]
	[message]
		speaker=Eridith
		message = _ "Eeek! This one isn't an illusion!"
	[/message]
[/event]

#enddef

{DISPEL_ILLUSION (Dark Warrior)}
{DISPEL_ILLUSION (Dark Headhunter)}
{DISPEL_ILLUSION (Dark Fighter)}
{DISPEL_ILLUSION (Dark Cultist)}
{DISPEL_ILLUSION (Dark Adept)}
{DISPEL_ILLUSION (Dark Champion)}

[event]
	name=die
	first_time_only=no
	[filter]
		side=2
	[/filter]
	[if]
		[not]
		[have_unit]
			side=2
		[/have_unit]
		[/not]
		[then]
			[message]
				speaker=Viktor
				message= _ "That was too easy. Surely they can't be the only guards in the cave."
			[/message]
			[message]
				speaker=Eridith
				message= _ "No Viktor. I sense there are many more apparitions ahead of us. More than I first thought."
			[/message]
			[message]
				speaker=Prince Sven
				message= _ "I think we'd better gather every dwarf we can muster here. I've got a bad feeling about what's ahead."
			[/message]
		[/then]
	[/if]
[/event]

[event]
	name=moveto
	[filter]
		x=13,13,10
		y=18,22,24
	[/filter]
	[message]
		speaker=Eridith
		message= _ "Be careful. When a new portal opens, the previous one will close. Anyone standing in the way will be killed."
	[/message]
[/event]

#define ILLUSION_GUARD TYPE X Y SIDE
	[unit]
		type={TYPE} illusion
		generate_name=yes
		x={X}
		y={Y}
		side={SIDE}
		animate=no
		ai_special=guardian
	[/unit]
#enddef

[event]
	name=moveto
	first_time_only=no
	[filter]
		x=13,13,10
		y=18,22,24
	[/filter]
	[if]
		[and]
		[have_unit]
			id=Viktor
			x=13,13,10
			y=18,22,24
		[/have_unit]
		[have_unit]
			id=Prince Sven
			x=13,13,10
			y=18,22,24
		[/have_unit]
		[have_unit]
		id=Eridith
			x=13,13,10
			y=18,22,24
		[/have_unit]
		[variable]
			name=phase
			equals=two
		[/variable]
		[/and]
	[then]
		[message]
			speaker=Viktor
			message = _ "Ready to go. Eridith, does it matter that the three runs are seperate?"
		[/message]
		[message]
			speaker=Eridith
			message = _ "Not at all. Each set of three tri-lock runes can be as close or as distant as can be."
		[/message]
		[message]
			speaker=Prince Sven
			message = _ "Let's keep going."
		[/message]
		[message]
			speaker=Eridith
			message = _ "On my count - one, two, three ..."
		[/message]
		[set_variable]
			name=phase
			value=three
		[/set_variable]
		[modify_turns] 
			value=60
		[/modify_turns]

		{QUAKE "rumble.ogg"}
		{QUAKE "rumble.ogg"}
		{RUNES-SPENT 13 18 13 22 10 24}
		[terrain]
			x=5,6-7
			y=14,13
			terrain=Xu
		[/terrain]
		[kill]
			x=5,6-7
			y=14,13
			animate=yes
			fire_event=yes
		[/kill]	
		[terrain]
			x=14-15,14-15,10
			y=18,22,25-26
			terrain=Uu
		[/terrain]
		{RUNES 50 25 48 30 50 34}
		[redraw]
			clear_shroud=yes
		[/redraw]
		[message]
			speaker=Prince Sven.
			message= _ "The portal's closed behind us. That should hold up the forces pursuing us."
		[/message]
		[message]
			speaker=Viktor
			message= _ "We'd still better get a move on. Whoever's guarding the stone will surely be mobilising as we speak."
		[/message]
		[unstore_unit]
			variable=dhawleesh
		[/unstore_unit]
		[unstore_unit]
			variable=verhahm
		[/unstore_unit]
		[unstore_unit]
			variable=vargon
		[/unstore_unit]
		[unstore_unit]
			variable=flanghan
		[/unstore_unit]
		[unstore_unit]
			variable=jehsen
		[/unstore_unit]

# Add some guardians as the passages get a bit boring otherwise.

	{ILLUSION_GUARD (Dark Headhunter) 30 14 5}
	{ILLUSION_GUARD (Dark Warrior) 30 15 5}
	{ILLUSION_GUARD (Dark Headhunter) 31 16 5}
	{ILLUSION_GUARD (Dark Headhunter) 30 25 6}
	{ILLUSION_GUARD (Dark Warrior) 31 26 6}
	{ILLUSION_GUARD (Dark Headhunter) 32 25 6}
	{ILLUSION_GUARD (Dark Headhunter) 22 39 7}
	{ILLUSION_GUARD (Dark Warrior) 22 40 7}
	{ILLUSION_GUARD (Dark Headhunter) 21 41 7}

	[objectives]
		side=1
		victory_string= _ "Objective II:"
			[objective]
				description= _ "Advance into the cavern"
				condition=win
				red=127
				green=127
				blue=127
			[/objective]
			[objective]
				description= _ "Find the next set of runes, and close the portal behind you"
				condition=win
			[/objective]
			[objective]
				description= _ "Death of Viktor"
				condition=lose
			[/objective]
			[objective]
				description= _ "Death of Prince Sven"
				condition=lose
			[/objective]
			[objective]
				description= _ "Death of Eridith"
				condition=lose
			[/objective]
	            {TURNS_RUN_OUT}
		note = _ "In this scenario, turn limits will be extended as individual objectives are completed."
	[/objectives]
	[/then]
	[/if]

[/event]
[event]
	name=moveto
	[filter]
		x=9-15,15-21
		y=27-33,15-39
		id=Prince Sven
	[/filter]
	[event]
		name=new turn
		[message]
			speaker=Prince Sven
			message= _ "It's like a labarynth though here."
		[/message]
		[message]
			speaker=Viktor
			message= _ "Eridith, do you know which way we should go? We can't wander through these caverns indefinitely."
		[/message]
		[message]
			speaker=Eridith
			message= _ "I can sense the manage of the runes. Let me concentrate ..."
		[/message]
		[message]
			speaker=Viktor
			message= _ "Well?"
		[/message]
		[message]
			speaker=Eridith
			message= _ "We have to follow the footprints."
		[/message]
		[message]
			speaker=Prince Sven
			message= _ "The footprints? But they go in three directions."
		[/message]
		[message]
			speaker=Eridith
			message= _ "The we must split into three groups. The next three tri-lock runes are seperate, so one runebearer must follow each path."
		[/message]
		[message]
			speaker=Prince Sven
			message= _ "What about the illusions? We can't dispel them if you're not around."
		[/message]
		[message]
			speaker=Eridith
			message= _ "I'm afraid so. You'll have to fight the apparitions without my help."
		[/message]
	[/event]
[/event]
[event]
	name=moveto
	first_time_only=no
	[filter]
		x=50,48,50
		y=25,30,34
	[/filter]
	[if]
		[and]
		[have_unit]
			id=Viktor
			x=50,48,50
			y=25,30,34
		[/have_unit]
		[have_unit]
			id=Prince Sven
			x=50,48,50
			y=25,30,34
		[/have_unit]
		[have_unit]
		id=Eridith
			x=50,48,50
			y=25,30,34
		[/have_unit]
		[variable]
			name=phase
			equals=three
		[/variable]
		[/and]
	[then]
		[message]
			speaker=Viktor
			message = _ "Thank goodness! We can't hold off these forces much longer!"
		[/message]
		[message]
			speaker=Prince Sven
			message = _ "Come on Eridith. Get this opened now!"
		[/message]
		[message]
			speaker=Eridith
			message = _ "One, two, three ..."
		[/message]
		[set_variable]
			name=phase
			value=three
		[/set_variable]
		{QUAKE "rumble.ogg"}
		{QUAKE "rumble.ogg"}
		{RUNES-SPENT 50 25 48 30 50 34}
		[terrain]
			x=14,14,10
			y=18,22,25
			terrain=Xu
		[/terrain]
		[kill]
			x=14,14,10
			y=18,22,25
			animate=yes
			fire_event=yes
		[/kill]	
		[terrain]
			x=51-52,49-50,51-52
			y=25,30,34
			terrain=Uu
		[/terrain]
		{RUNES 57 26 56 29 58 32}
		[redraw]
			clear_shroud=yes
		[/redraw]
		[message]
			speaker=Viktor
			message= _ "Quickly now! Get everyone through to portals!"
		[/message]
		[message]
			speaker=Eridith
			message = _ "Remember, when the next three runes are activated, those portals will close again. We can cut off the enemy on the other side."
		[/message]
		[set_variable]
			name=phase
			value=four
		[/set_variable]
	[/then]
	[/if]
[/event]

[event]
	name=moveto
	first_time_only=no
	[filter]
		x=57,56,58
		y=26,29,32
	[/filter]
	[if]
		[and]
		[have_unit]
			id=Viktor
			x=57,56,58
			y=26,29,32
		[/have_unit]
		[have_unit]
			id=Prince Sven
			x=57,56,58
			y=26,29,32
		[/have_unit]
		[have_unit]
		id=Eridith
			x=57,56,58
			y=26,29,32
		[/have_unit]
		[variable]
			name=phase
			equals=four
		[/variable]
		[/and]
	[then]
		[message]
			speaker=Viktor
			message = _ "Hurry! No time to lose!"
		[/message]
		[message]
			speaker=Eridith
			message = _ "One, two, three ..."
		[/message]
		[set_variable]
			name=phase
			value=five
		[/set_variable]
		{QUAKE "rumble.ogg"}
		{QUAKE "rumble.ogg"}
		{RUNES-SPENT 57 26 56 29 58 32}
		[modify_turns] 
			value=100
		[/modify_turns]
		[terrain]
			x=51,49,51
			y=25,30,34
			terrain=Xu
		[/terrain]
		[kill]
			x=51,49,51
			y=25,30,34
			animate=yes
			fire_event=yes
		[/kill]	
		[terrain]
			x=58,59,57,58,59,60
			y=26,27,29,29,32,31
			terrain=Uu
		[/terrain]
		[redraw]
			clear_shroud=yes
		[/redraw]
		[modify_side]
			side=1
			fog=no
		[/modify_side]
		[place_shroud]
			side=1
			x=1-50
			y=1-50
		[/place_shroud]
		[music]
			name=null.ogg
			immediate=yes
		[/music]
		[message]
			speaker=Prince Sven
			message= _ "Thank goodness! I thought they'd had us for a moment."
		[/message]
		[message]
			speaker=Eridith
			message= _ "At least the paths are joining again."
		[/message]
		[message]
			speaker=Viktor
			message = _ "Quite. Let's have a rest, regroup, then stick together."
		[/message]
		[music]
			name=underground.ogg
			immediate=yes
		[/music]

# Reset gold to zero if gold has fallen to a negative value.
		[store_gold]
			side=1
		[/store_gold]

		[if]
		[variable]
			name=gold
			less_than=0
		[/variable]
		[then]
			[set_variable]
				name=gold
				multiply=-1
			[/set_variable]
			[gold]
				side=1
				amount=$gold
			[/gold]
		[/then]
		[/if]
		[if]
			[have_unit]
				id=Viktor
				x=57
				y=26
			[/have_unit]
			[then]
			[role]
				type=UL_Dwarvish Thunderer,UL_Dwarvish Fighter,Dwarvish Guardsman,Dwarvish Thunderguard,Dwarvish Flamethrower,Dwarvish Steelclad,Dwarwish Runesmith,Dwarvish Stalwart,Dwarvish Dragonguard,Dwarvish Lord,Dwarwish Runemaster,Dwarvish Sentinel
				[not]
				id=Halgar the Mighty
				[/not]
				x=52-54
				y=22-27
				role=corpse_spotter
			[/role]
		[/then]
		[/if]

# Next line said by a dwarf in the same chamber as Viktor

		[if]
			[have_unit]
				id=Viktor
				x=56
				y=29
			[/have_unit]
			[then]
			[role]
				type=UL_Dwarvish Thunderer,UL_Dwarvish Fighter,Dwarvish Guardsman,Dwarvish Thunderguard,Dwarvish Flamethrower,Dwarvish Steelclad,Dwarwish Runesmith,Dwarvish Stalwart,Dwarvish Dragonguard,Dwarvish Lord,Dwarwish Runemaster,Dwarvish Sentinel
				[not]
				id=Halgar the Mighty
				[/not]
				x=51-56
				y=28-31
				role=corpse_spotter
			[/role]
		[/then]
		[/if]
		[if]
			[have_unit]
				id=Viktor
				x=58
				y=32
			[/have_unit]
			[then]
			[role]
				type=UL_Dwarvish Thunderer,UL_Dwarvish Fighter,Dwarvish Guardsman,Dwarvish Thunderguard,Dwarvish Flamethrower,Dwarvish Steelclad,Dwarwish Runesmith,Dwarvish Stalwart,Dwarvish Dragonguard,Dwarvish Lord,Dwarwish Runemaster,Dwarvish Sentinel
				[not]
				id=Halgar the Mighty
				[/not]
				x=52-58
				y=32-37
				role=corpse_spotter
			[/role]
		[/then]
		[/if]

		[message]
			role=corpse_spotter
			message = _ "Eeeeeuw! ... Viktor, sorry to interrupt, but you might want to take a look at this."
		[/message]
		[message]
			speaker=Viktor
			message = _ "What have you found?"
		[/message]
		[message]
			role=corpse_spotter
			message = _ "The dwarves. I've found the dwarves from the other army."
		[/message]
		[message]
			speaker=Viktor
			message = _ "I can't see anything. Where are they?"
		[/message]
		[message]
			role=corpse_spotter
			message = _ "You're standing in them."
		[/message]
		[message]
			speaker=Viktor
			message = _ "Good god! What's happened to them?"
		[/message]
		[message]
			speaker=Prince Sven
			message = _ "There's corpses everywhere! It's like they've been chopped into tiny little pieces!"
		[/message]
		[message]
			speaker=Eridith
			message = _ "This is horrific! Even Zharagorn's men aren't this bloodthirsty. Who would do such a thing?"
		[/message]
		[message]
			speaker=Viktor
			message = _ "Oh well, at least some of their equipment has been left undamaged. We may as well take what we can. I can only assume whoever did this wasn't interested in what they had with them."
		[/message]
		[sound]
			name=gold.ogg
		[/sound]
		[message]
			speaker=narrator
			message= _ "You gain 100 pieces of gold."
		[/message]
		[gold]
			side=1
			amount=100
		[/gold]
		[message]
			speaker=Golran
			message = _ "There's something very wrong here. Something about the way they've been butchered doesn't seem right."
		[/message]
		[message]
			speaker=Eridith
			message = _ "Viktor, we must gather all our forces together before continuing. We've got to be prepared for whoever did this."
		[/message]
	[objectives]
		side=1
			[objective]
				description= _ "Advance into the cavern"
				condition=win
				red=127
				green=127
				blue=127
			[/objective]
			[objective]
				description= _ "Find the next set of runes, and close the portal behind you"
				condition=win
				red=127
				green=127
				blue=127
			[/objective]
			[objective]
				description= _ "Find and destroy the Black Emerald"
				condition=win
			[/objective]
			[objective]
				description= _ "Death of Viktor"
				condition=lose
			[/objective]
			[objective]
				description= _ "Death of Prince Sven"
				condition=lose
			[/objective]
			[objective]
				description= _ "Death of Eridith"
				condition=lose
			[/objective]
	            {TURNS_RUN_OUT}
            		[gold_carryover]
             		   bonus=no
        		[/gold_carryover]
	[/objectives]

		[event]
			name=new_turn
			[message]
				speaker=Prince Sven
				message = _ "Hey, has anyone else noticed the mist has gone?"
			[/message]
			[message]
				speaker=Eridith
				message = _ "Not gone, just a different mist. A magical mist only I can see. We are very close now."
			[/message]
		[/event]

	[/then]
	[/if]
[/event]

[event]
	name=moveto
	[filter]
		x=63-75
		y=23-31
	[/filter]
	[music]
		name=null.ogg
		immediate=yes
	[/music]
	[message]
		speaker=unit
		message = _ "Whoah! ... You'd better take a look at this."
	[/message]
	{MOVE_UNIT id=Eridith 63 25}
	{MOVE_UNIT id=Viktor 64 25}
	{MOVE_UNIT (id=Prince Sven) 65 25}
	[item]
		x=64
		y=15
		image=items/ball-green.png
	[/item]
	[remove_shroud]
		side=1
		x=57-62,63-75,61-62
		y=18-24,15-27,17
	[/remove_shroud]
	[music]
		name=heroes_rite.ogg
		immediate=yes
	[/music]
	[message]
		speaker=Viktor
		message = _ "This cavern's massive!"
	[/message]
	[message]
		speaker=Prince Sven
		message = _ "You're telling me! I've never seen anything like it, and I've been in loads of caves."
	[/message]
	[message]
		speaker=Eridith
		message = _ "This is no ordinary cavern. It's a magical cavern. Surely this means- ... Look! There!"
	[/message]
	[scroll_to]
		x=64
		y=15
	[/scroll_to]
	[delay]
		time=1000
	[/delay]
	[message]
		speaker=Viktor
		message = _ "Is that it? The Black Emerald?"
	[/message]
	[message]
		speaker=Eridith
		message = _ "It has to be. I can feel the magic radiating. Far too powerful to be from a fake."
	[/message]
	[message]
		speaker=Prince Sven
		message = _ "And there's nothing standing between us apart from the chasm?"
	[/message]
	[message]
		speaker=Eridith
		message = _ "Who knows? There's got to be some sort of defence, but I don't know what."
	[/message]
	[message]
		speaker=Viktor
		message = _ "Let's take this one step at a time. How are we going to get across that chasm?"
	[/message]
	[message]
		speaker=Eridith
		message = _ "That's funny ... I can sense there's another set of tri-lock runes but ... something is surpressing this - something or someone?"
	[/message]
	[message]
		speaker=Prince Sven
		message = _ "Look out!"
	[/message]
	[message]
		speaker=Viktor
		message = _ "Where?"
	[/message]
	[unstore_unit]
		variable=chief_deserter
	[/unstore_unit]
	[modify_unit]
	  [filter]
	    id=$chief_deserter.id
	  [/filter]
	  x,y=70,15
	[/modify_unit]
	{MOVE_UNIT id=$chief_deserter.id 69 17}
	[message]
		speaker=$chief_deserter.id
		message = _ "Hello, my friends!"
	[/message]
	[message]
		speaker=Prince Sven
		message = _ "I don't believe it! It's $chief_deserter.name!"
	[/message]
	[message]
		speaker=$chief_deserter.id
		message = _ "I'm so pleased to see you!"
	[/message]
	[message]
		speaker=Viktor
		message = _ "Us too! We thought you were dead."
	[/message]
	[message]
		speaker=Prince Sven
		message = _ "What happened to you? One moment you were with us, the next we'd lost you."
	[/message]
	[message]
		speaker=$chief_deserter.id
		message = _ "I got seperated from you ... It was strange. I'd only fallen behind a moment, the next moment you'd all gone. I'd taken a wrong turn into a narrow passage - a passage no-one else had seen."
	[/message]
	[message]
		speaker=Viktor
		message = _ "You should have called for help. You know we'd have come back for you."
	[/message]
	[message]
		speaker=$chief_deserter.id
		message = _ "I hear what you're saying, but- ... I had a strange feeling I was meant to go this way. I just carried on following the passage and found myself here."
	[/message]
	[message]
		speaker=Viktor
		message = _ "Did you find any other passages? Can they get us across the chasm?"
	[/message]
	[message]
		speaker=$chief_deserter.id
		message = _ "Yes. I've already been over the other side."
	[/message]
	[message]
		speaker=Eridith
		message = _ "You've already been? You fool, that thing could have killed you!"
	[/message]
	[message]
		speaker=$chief_deserter.id
		message = _ "It's okay, it's completely safe. We're past all the guards now. It's just us and the stone."
	[/message]
	[message]
		speaker=Eridith
		message = _ "Well stay away from the stone! Only I know how to destroy it."
	[/message]
	[message]
		speaker=$chief_deserter.id
		message = _ "Wait ... hear me out for a moment. We need to think about what we're doing."
	[/message]
	[message]
		speaker=Viktor
		message = _ "What do you mean?"
	[/message]
	[message]
		speaker=Golran
		message = _ "(Viktor, be careful. There's something about this I don't like.)"
	[/message]
	[music]
		name=suspense.ogg
		immediate=yes
	[/music]
	[message]
		speaker=$chief_deserter.id
		message = _ "I'm not sure we should destroy it."
	[/message]
	[message]
		speaker=Prince Sven
		message = _ "WHAT?!?!? You've got to be joking!"
	[/message]
	[message]
		speaker=$chief_deserter.id
		message = _ "Please, think about it. Supposing we destroy the stone, then what? What's to say Zharagorn's forces will be broken? Yes, it might stop him recruiting new followers, but he's already got a big enough army to conquer all of Suveran."
	[/message]
	[message]
		speaker=Viktor
		message = _ "No, that's not true! His forces will be broken ... won't they Eridith?"
	[/message]
	[message]
		speaker=Eridith
		message = _ "We must have faith in the plan. There is no other-"
	[/message]
	[message]
		speaker=$chief_deserter.id
		message = _ "Can't you see? The old fool Deuterus didn't think it through. If we destroy the Black Emerald, it will be all for nothing ... It's power is beyond compare. We should use it against Zharagorn."
	[/message]
	[message]
		speaker=Viktor
		message = _ "No, we can't!"
	[/message]
	[message]
		speaker=Eridith
		message = _ "$chief_deserter.name, listen to me, the stone is evil. Nothing good can come from using it."
	[/message]
	[message]
		speaker=$chief_deserter.id
		message = _ "Just think. Imagine the way the once-mighty forces of Zharagorn will break and run when they see the greatest dwarvish army in the world descend on them. They'll be nothing. We will be supreme."
	[/message]
	[message]
		speaker=Prince Sven
		message = _ "Please, $chief_deserter.name, you're making a big mistake."
	[/message]
	[message]
		speaker=$chief_deserter.id
		message = _ "Oh no, it's you who's making the mistake. When Zharagorn is defeated, it won't end there. We'll stop playing second fiddle to King Gamaron. He'll give us the respect we dwarves deserve. We'll be their equals - no, their betters. And then we'll see to our enemies ..."
	[/message]
	[message]
		speaker=Prince Sven
		message = _ "$chief_deserter.name, wait!"
	[/message]
	[message]
		speaker=$chief_deserter.id
		message = _ "Those orcs we've met. We'll track them down, and they'll die in agony they've never imagined. And those treacherous elves of Elith-Maranon - we'll make them pay too. We'll make them pay with the blood of every last elvish man, woman and child ..."
	[/message]
	[message]
		speaker=Viktor
		message = _ "My God!"
	[/message]
	[message]
		speaker=Eridith
		message = _ "$chief_deserter.name, you must get these these thoughts out of your head now! It's is not you coming up with these ideas, it is the Black Emerald putting these thoughts in your head!"
	[/message]
	[message]
		speaker=$chief_deserter.id
		message = _ "So what if it has? It's mine now. I'm the new master of the stone."
	[/message]
	[message]
		speaker=Eridith
		message = _ "The Black Emerald has no master. The Black Emerald IS the master!"
	[/message]
	[message]
		speaker=Golran
		message = _ "Viktor, I've just realised what it was about those dead dwarves. Those wounds came from dwarven axes!"
	[/message]
	[modify_unit]
	  [filter]
	    id=$chief_deserter.id
	  [/filter]
	  side=8
	  canrecruit=yes
	[/modify_unit]
	[music]
		name=drums-ominous.ogg
		immediate=yes
	[/music]
	[message]
		speaker=$chief_deserter.id
		message = _ "Oh yes, those other dwarves. They saw the light, just like I did ... But not all of them. Some of them were just like you."
	[/message]
	[terrain]
		x=68-70
		y=16-17
		terrain=Cud
	[/terrain]
	[terrain]
		x=69
		y=18
		terrain=Cud
	[/terrain]
	[terrain]
		x=69
		y=17
		terrain=Kud
	[/terrain]
	[redraw]
	[/redraw]
	[unit]
		type=Dwarvish Berserker
		id=Grogran
		name= _ "Grogran"
		x=68
		y=18
		random_traits=yes
		side=8
		animate=yes
	[/unit]
	[unit]
		type=Dwarvish Berserker
		id=Hareld
		name= _ "Hareld"
		x=70
		y=18
		random_traits=yes
		side=8
		animate=yes
	[/unit]
	[message]
		speaker=Grogran
		message = _ "They said we shouldn't use the stone either. Said that they couldn't let us do that. They had to go."
	[/message]
	[message]
		speaker=Hareld
		message = _ "We dealt with them. We hacked and slashed and we pounded again and again and again until there was nothing left."
	[/message]
	[message]
		speaker=$chief_deserter.id
		message = _ "You see, no-one can keep the enlightened from our ranks. Not even you."
	[/message]
	[unstore_unit]
		variable=deserter2
	[/unstore_unit]
	[modify_unit]
	  [filter]
	    id=$deserter2.id
	  [/filter]
	  x,y=68,17
	  side=8
	[/modify_unit]
	[message]
		speaker=$deserter2.id
		message = _ "I saw the light too, Viktor. How foolish of you not to join us."
	[/message]
	[unstore_unit]
		variable=deserter3
	[/unstore_unit]
	[modify_unit]
	  [filter]
	    id=$deserter3.id
	  [/filter]
	  x,y=70,17
	  side=8
	[/modify_unit]
	[message]
		speaker=$deserter3.id
		message = _ "Prince Sven, you were a good ruler. It's a shame we have to kill you."
	[/message]
	[unstore_unit]
		variable=deserter4
	[/unstore_unit]
	[modify_unit]
	  [filter]
	    id=$deserter4.id
	  [/filter]
	  x,y=68,16
	  side=8
	[/modify_unit]
	[message]
		speaker=$deserter4.id
		message = _ "I blame that so-called wise woman. Should brought this fate upon you."
	[/message]
	[unstore_unit]
		variable=deserter5
	[/unstore_unit]
	[modify_unit]
	  [filter]
	    id=$deserter5.id
	  [/filter]
	  x,y=70,16
	  side=8
	[/modify_unit]
	[message]
		speaker=$deserter5.id
		message = _ "This is goodbye, former friends."
	[/message]

# Deduct 20 gold per dwarf recalled, to mimic recall cost

	[set_variable]
		name=gold_deduction
		value=$deserters
	[/set_variable]
	[set_variable]
		name=gold_deduction
		multiply=-20
	[/set_variable]
	[gold]
		side=8
		amount=$gold_deduction
	[/gold]
	[message]
		speaker=Prince Sven
		message = _ "No ... don't do this!"
	[/message]
	[message]
		speaker=$chief_deserter.id
		message = _ "You leave us with no choice. If you are not with us, then you are against us. And if you are against us, you must die."
	[/message]
	[message]
		speaker=Eridith
		message = _ "I'm sorry Viktor, it's no use trying to reason. They have gone over to the other side, and it's too late to bring them back."
	[/message]
	[message]
		speaker=Viktor
		message = _ "Forgive me for what we must do. To arms!"
	[/message]
	[music]
		name=battle.ogg
		immediate=yes
	[/music]
	[music]
		name=heroes_rite.ogg
		append=yes
	[/music]
[/event]

[event]
	name=last_breath
	[filter]
		id=$chief_deserter.id
	[/filter]
	[message]
		speaker=second_unit
		message = _ "Please, $chief_deserter.name, don't make me do this."
	[/message]
	[message]
		speaker=$chief_deserter.id
		message = _ "I will never give in! You're weaklings, you're cowards! I shall be honoured and you shall all die in agony!"
	[/message]
	[message]
		speaker=second_unit
		message = _ "$chief_deserter.name, I'm really really sorry."
	[/message]
[/event]

[event]
	name=die
	first_time_only=no
	[filter]
		side=8
	[/filter]
	[if]
		[not]
		[have_unit]
			side=8
		[/have_unit]
		[/not]
		[then]
			[music]
				name=underground.ogg
				immediate=yes
			[/music]
			[message]
				speaker=Viktor
				message = _ "Please, let this be the last battle. I can't take another one like that."
			[/message]
			[message]
				speaker=Eridith
				message = _ "The runes are coming back! The dwarves we fought were somehow surpressing the magic."
			[/message]
			[scroll_to]
				x=62
				y=18
			[/scroll_to]
			[sound]
				name=magic-dark.ogg
			[/sound]
			[item]
				x=62
				y=18
				image=scenery/rune1-glow.png
			[/item]

			[delay]
				time=1000
			[/delay]
			[sound]
				name=magic-dark-big.ogg
			[/sound]
			[scroll_to]
				x=67
				y=16
			[/scroll_to]
			[item]
				x=67
				y=16
				image=scenery/rune2-glow.png
			[/item]

			[delay]
				time=1000
			[/delay]
			[sound]
				name=magic-dark.ogg
			[/sound]
			[scroll_to]
				x=73
				y=16
			[/scroll_to]
			[item]
				x=73
				y=16
				image=scenery/rune3-glow.png
			[/item]
			[music]
				name=underground.ogg
				immediate=yes
			[/music]
			[message]
				speaker=Eridith
				message = _ "That's the last set of runes. It's now just us, the stone, and whatever's guarding it."
			[/message]
			[message]
				speaker=Prince Sven
				message = _ "Then whoever's guarding it shall pay for they just made us do."
			[/message]
			[set_variable]
				name=phase
				value=six
			[/set_variable]
		[/then]
	[/if]
[/event]

[event]
	name=moveto
	first_time_only=no
	[filter]
		x=62,67,73
		y=18,16,16
	[/filter]
	[if]
		[and]
		[have_unit]
			id=Viktor
			x=62,67,73
			y=18,16,16
		[/have_unit]
		[have_unit]
			id=Prince Sven
			x=62,67,73
			y=18,16,16
		[/have_unit]
		[have_unit]
			id=Eridith
			x=62,67,73
			y=18,16,16
		[/have_unit]
		[variable]
			name=phase
			equals=six
		[/variable]
		[/and]
	[then]
		[message]
			speaker=Prince Sven
			message = _ "So this is it then? Just one more to go."
		[/message]
		[message]
			speaker=Viktor
			message = _ "Yes - just one more ... I just want to say that whatever happens on the other side, it has been a privilege to do this journey with you."
		[/message]
		[message]
			speaker=Prince Sven
			message = _ "Viktor?"
		[/message]
		[message]
			speaker=Viktor
			message = _ "And ... Eridith - I just want to say - whatever you have to do now, I won't begrudge you for it. I trust you to do what you think best."
		[/message]
		[message]
			speaker=Eridith
			message = _ "Viktor, I don't understand."
		[/message]
		[message]
			speaker=Prince Sven
			message = _ "Yes, you've been acting more and more strangely the closer we've got to our goal."
		[/message]
		[message]
			speaker=Viktor
			message = _ "All I'm saying is ... if there's anything you haven't told me - if there's a part of the plan I musn't know - whatever sacrifice I must make-"
		[/message]
		[message]
			speaker=Eridith
			message = _ "What are you saying? ... Viktor, Prince Sven, I want to make this clear: there's nothing I know that I haven't told you already. As far as I'm concerned, after the Black Emerald is destroyed, I intend us to leave this place alive. All of us."
		[/message]
		[message]
			speaker=Viktor
			message = _ "Right - well - if you're sure."
		[/message]
		[message]
			speaker=Eridith
			message = _ "Enough! We must proceed. One ... two ... three ..."
		[/message]
		[set_variable]
			name=phase
			value=seven
		[/set_variable]
		{QUAKE "rumble.ogg"}
		{QUAKE "rumble.ogg"}
		{RUNES-SPENT 62 18 67 16 73 16}
		[terrain]
			x=58,57,59
			y=26,29,32
			terrain=Xu
		[/terrain]
		[kill]
			x=51,49,51
			y=25,30,34
			animate=yes
			fire_event=yes
		[/kill]	
		[terrain]
			x=62,67,74
			y=17,15,15
			terrain=Uu
		[/terrain]
		[redraw]
			clear_shroud=yes
		[/redraw]
		[remove_shroud]
			side=1
			x=58-75
			y=1=16
		[/remove_shroud]
		[music]
			name=heroes_rite.ogg
			immediate=yes
		[/music]
		[event]
		name=new_turn
			[message]
				speaker=Viktor
				message = _ "Is that it? I can't see anyone through here."
			[/message]
			[message]
				speaker=Prince Sven
				message = _ "I don't like this. There's got to be a trap."
			[/message]
			[message]
				speaker=Eridith
				message = _ "Viktor, only I can finish this now. I must reach the Black Emerald so that I can destroy it."
			[/message]
		[/event]
	[/then]
	[/if]
[/event]

[event]
	name=moveto
	[filter]
		x=64
		y=15
		id=Eridith
	[/filter]
	[music]
		name=null.ogg
		immediate=yes
	[/music]
	[message]
		speaker=Eridith
		message = _ "So, here we are."
	[/message]
	[message]
		speaker=Viktor
		message = _ "What happens now?"
	[/message]
	[message]
		speaker=Eridith
		message = _ "When I touch the stone, I will be pitting my power against stone's. Once that begins, only one of us will survive."
	[/message]
	[message]
		speaker=Prince Sven
		message = _ "Okay. I hope you know what you're doing."
	[/message]
	{QUAKE "rumble.ogg"}
	{QUAKE "rumble.ogg"}
	[music]
		name=drums-ominous.ogg
		immediate=yes
	[/music]
	[modify_unit]
		[filter]
			id=Eridith
		[/filter]
		max_moves=0
		attacks=0
	[/modify_unit]
	[message]
		speaker=Eridith
		message = _ "Gnnnngggghhhh! ... Gnnnnggghhhh! ... Aaaagghhhhh!"
	[/message]
	[message]
		speaker=Viktor
		message = _ "Eridith, what's happening?"
	[/message]
	[message]
		speaker=Eridith
		message = _ "Cannot ... speak ... must ... devote ... all ... energy ... to- ... GGNNNGGHHH!!! AAAGGGGHHH!!!"
	[/message]
	[message]
		speaker=Prince Sven
		message = _ "Can we help you?"
	[/message]
	[message]
		speaker=Eridith
		message = _ "Protect ... me ... from ... AAAGGGHHHHH!!!!"
	[/message]
	[message]
		speaker=Prince Sven
		message = _ "Protect you from what?"
	[/message]
	[message]
		speaker=Viktor
		message = _ "Oh no ... that's impossible!"
	[/message]
	[unit]
		type=Dark Overlord
		id=Zharagorn
		name = _ "Zharagorn"
		x=65
		y=4
		canrecruit=yes
		side=9
		animate=yes
	[/unit]
	[message]
	speaker=Zharagorn
	message = _ "Did you think I would stand back and let you destroy my most prized possession? No, this cave shall be your tomb after I slay you all."
	[/message]
	[unit]
		type=Dark Sorcerer
		generate_name=yes
		x=64
		y=4
		side=9
		animate=yes
	[/unit]
	[unit]
		type=Necromancer
		generate_name=yes
		x=65
		y=5
		side=9
		animate=yes
	[/unit]
	[unit]
		type=Dark Soulhunter
		generate_name=yes
		x=65
		y=5
		side=9
		animate=yes
	[/unit]
	[unit]
		type=Dark Marauder
		generate_name=yes
		x=63
		y=5
		side=9
		animate=yes
	[/unit]
	[unit]
		type=Dark Warrior
		generate_name=yes
		x=64
		y=5
		side=9
		animate=yes
	[/unit]
	[unit]
		type=Dark Sorcerer
		generate_name=yes
		x=65
		y=6
		side=9
		animate=yes
	[/unit]
	[unit]
		type=Dark Adept
		generate_name=yes
		x=63
		y=6
		side=9
		animate=yes
	[/unit]
	[unit]
		type=Dark Fighter
		generate_name=yes
		x=64
		y=6
		side=9
		animate=yes
	[/unit]
	[unit]
		type=Dark Fighter
		generate_name=yes
		x=65
		y=7
		side=9
		animate=yes
	[/unit]
	[unit]
		type=Dark Headhunter
		generate_name=yes
		x=66
		y=6
		side=9
		animate=yes
	[/unit]
	[unit]
		type=Dark Cultist
		generate_name=yes
		x=62
		y=5
		side=9
		animate=yes
	[/unit]
	[unit]
		type=Dark Cultist
		generate_name=yes
		x=62
		y=6
		side=9
		animate=yes
	[/unit]
	[unit]
		type=Dark Cultist
		generate_name=yes
		x=63
		y=6
		side=9
		animate=yes
	[/unit]
	[unit]
		type=Dark Cultist
		generate_name=yes
		x=64
		y=7
		side=9
		animate=yes
	[/unit]
	[unit]
		type=Dark Cultist
		generate_name=yes
		x=65
		y=8
		side=9
		animate=yes
	[/unit]
	[unit]
		type=Dark Cultist
		generate_name=yes
		x=66
		y=7
		side=9
		animate=yes
	[/unit]
	[message]
		speaker=Viktor
		message = _ "Eridith, are these more illusions?"
	[/message]
	[message]
		speaker=Eridith
		message = _ "Gnnnggghhhh!"
	[/message]
	[message]
		speaker=Viktor
		message = _ "They have to be illusions! Zharagorn can't be down here!"
	[/message]
	[message]
		speaker=Prince Sven
		message = _ "It doesn't matter. Eridith is out of action. We've no choice but to fight."
	[/message]
	[music]
		name=vengeful.ogg
		immediate=yes
	[/music]
	[music]
		name=casualties_of_war.ogg
		append=yes
	[/music]
	[music]
		name=frantic.ogg
		append=yes
	[/music]
[/event]

[event]
	name=die
	[filter]
		id=Zharagorn
	[/filter]
	[music]
		name=null.ogg
		immediate=yes
	[/music]
	[message]
		speaker=Zharagorn
		message = _ "Aaaaaaaggggghhhhhh!"
	[/message]
	[message]
		speaker=Eridith
		message = _ "Gnnnggghhhh!"
	[/message]
	[message]
		speaker=Viktor
		message = _ "Eridith, what's happening now."
	[/message]
	[message]
		speaker=Eridith
		message = _ "It's ... Must push ... Mush push harder ... Gnnnggghhhh ..."
	[/message]
	[sound]
	name=lightning.ogg
	[/sound]

	[color_adjust]
	red=100
	green=100
	blue=100
	[/color_adjust]

	[delay]
	time=10
	[/delay]

	[color_adjust]
	red=0
	green=0
	blue=0
	[/color_adjust]
	[kill]
		side=9
	[/kill]
	[remove_item]
		x=64
		y=15
	[/remove_item]
	[redraw]
	[/redraw]
	[message]
		speaker=Eridith
		message = _ "I've done it. It's gone."
	[/message]
        [message]
            speaker=narrator
            image="story/book.png"
            message= _ "And so it had. The Black Emerald lay out our feet, shattered into a million pieces. I couldn't believe it: I was alive. Somehow I'd been convinced that I, like Deuterus, would have to die for the quest to succeed. I had never felt happier to be wrong."
        [/message]
	[music]
		name=elf-land.ogg
		immediate=yes
	[/music]
	[message]
		speaker=Viktor
		message = _ "I can't believe it, we've done it! It's over."
	[/message]
	[message]
		speaker=Prince Sven
		message = _ "Hey, where did all those bodies go?"
	[/message]
	[message]
		speaker=Eridith
		message = _ "Those things you fought - they were all apparitions too. I'm sorry I couldn't help you."
	[/message]
	[message]
		speaker=Golran
		message = _ "You mean the Zharagorn we just killed wasn't the real one?"
	[/message]
	[message]
		speaker=Viktor
		message = _ "That means the real Zharagorn is still out there."
	[/message]
	[message]
		speaker=Prince Sven
		message = _ "What does it matter? The Black Emerald is destroyed. His army is broken!"
	[/message]
	[message]
		speaker=Viktor
		message = _ "Hmm ... We can't be too careful. He found a powerful artefact once, what's to say he won't find another? I think we should track him down and stop him once and for all."
	[/message]
	[message]
		speaker=Prince Sven
		message = _ "All right. Let's get out of here, get back to Aldanen, and think about what to do next. There won't be any more illusions now, will there?"
	[/message]
	[message]
		speaker=Eridith
		message = _ "Not, not apparations. They were all powered by the Black Emerald, so they can't-"
	[/message]
	[music]
		name=null.ogg
		immediate=yes
	[/music]
	[unit]
		type=Dark Overlord
		id=Zharagorn
		name = _ "Zharagorn"
		x=65
		y=4
		canrecruit=yes
		side=9
		animate=yes
	[/unit]
	{MOVE_UNIT id=Zharagorn 64 10}
	[message]
	speaker=Zharagorn
	message = _ "So, you have destroyed the most treasured of my possessions. I do not let deeds like this go unnoticed. Such audacity must be rewarded."
	[/message]
	[music]
		name=suspense.ogg
		append=yes
	[/music]
	[message]
		speaker=Viktor
		message = _ "You said there would be no more illusions!"
	[/message]
	[message]
		speaker=Eridith
		message = _ "It's okay, it's only a phantasm, not an apparition. It can harm us, we can't harm it."
	[/message]
	[message]
	speaker=Zharagorn
	message = _ "If you have destroyed the Black Emerald, then I can assume you have evaded my forces, discovered the secret of my phantom army, found a way through the tri-lock runes, resisted the mind control of the stone, and fought off the apparition of myself in the last line of defence. Clearly you are resourceful to have achieved all of this, and for that, I must congratulate you."
	[/message]
	[message]
		speaker=Prince Sven
		message = _ "Say what you like! You've lost!"
	[/message]
	[message]
		speaker=Eridith
		message = _ "He can't hear us. It's just a message."
	[/message]
	[message]
	speaker=Zharagorn
	message = _ "But before leave the cave, ask yourself this: do you think I would have really made this so easy if it mattered to me? You must know the legend of the Circle of Druids, who I hunted down in person with my Darkguard. Had I done the same to you, you would all have been slaughtered long before you reached the cave. So why did I allow you get this far at all?"
	[/message]
	[message]
		speaker=Golran
		message = _ "(I don't like this. He's looking too confident.)"
	[/message]
	[message]
	speaker=Zharagorn
	message = _ "The simple answer is that this time, I made preparations. I can of course track down and kill anyone I consider to be a threat, but one thing I learnt from the last invasion is that I am best placed with my invincible army, leading the assault on the city of Karasov from beginning to end. I cannot afford these distractions, and that is why I distributed the Black Emerald's power amongst other artefacts using magic known only to me. Don't try to find them, no-one but I knows what they are."
	[/message]
	[message]
	speaker=Zharagorn
	message = _ "So let me make it clear where we stand. The siege of Karasov will go ahead as planned. My unstoppable legion marches on, undaunted and unbroken."
	[/message]
	[message]
		speaker=Viktor
		message = _ "No, it can't be!"
	[/message]
	[message]
	speaker=Zharagorn
	message = _ "Now for your reward: I shall let you into a secret. The truth is that I have no wish to rule the capital of Suveran. I will have more than enough slaves under my command as it is. I shall of course wait until my full force is assembled before launching the assault, to give your King time to contemplate his fate, but I no longer want the throne for myself. Instead, I shall turn the city over to Mal-Margheera, so that everyone inside shall serve forever in glorious death!"
	[/message]
	[message]
	speaker=Zharagorn
	message = _ "When this is all over, I would like to meet you and see how you managed to get so far. Sadly, that is not an option. As you are capable of destroying my Black Emerald, you are too dangerous to be allowed to live. So an alarm went off the moment you entered the cave, and my Darkguard has been despatched to kill you all. I shall unfortuantely be unable to take part myself, but please consider me there in spirit."
	[/message]
	[message]
	speaker=Zharagorn
	message = _ "I shall leave you with one piece of advice. It may take several days for the Darkguard to come for you. If I were you, I would try to head west for the coast. If you are lucky, you might be able to find a ship, and sail far away from this land, never to return. Of course, if you wish to stay and fight a doomed cause, be my guest ... but you already know you're doomed."
	[/message]
	[kill]
		id=Zharagorn
		animate=no
	[/kill]
	[sound]
		name=magic-dark-big.ogg
	[/sound]
	[message]
		speaker=Viktor
		message = _ "No, that can't be true!"
	[/message]
	[message]
		speaker=Prince Sven
		message = _ "It's a bluff! I don't believe you."
	[/message]
        [message]
            speaker=narrator
            image="story/book.png"
            message= _ "But even as we spoke, deep inside we knew Zharagorn was right. Somehow, he had found a way to make our journey to the World's End Mountains count for nothing. I couldn't believe it."
        [/message]
	[message]
		speaker=Eridith
		message = _ "Viktor, there is nothing more we can do here. We can only journey back to my village and consider what we do next."
	[/message]
	[message]
		speaker=Viktor
		message = _ "But what can we do next?"
	[/message]
	[message]
		speaker=Eridith
		message = _ "That is something we will reflect on."
	[/message]
	[endlevel]
		result=victory
		bonus=no
	[/endlevel]

[/event]
# Defeat

	{~add-ons/The_Unstoppable_Legion/utils/deaths.cfg}

[event]
	name=die
	[filter]
		id=Eridith
	[/filter]
	[music]
		name=null.ogg
		immediate=yes
	[/music]
	[message]
		speaker=Eridith
		message= _ "No! I've failed my people!"
	[/message]
	[message]
		speaker=Viktor
		message= _ "Oh no! We needed Eridith to destroy the crystal for us!"
	[/message]
	[endlevel]
		result=defeat
	[/endlevel]
[/event]
[event]
	name=turns over

	[switch]
		variable=phase
		[case]
		value=one
		[message]
			speaker=Viktor
			message= _ "It's too late! The forces following us have caught up!"
		[/message]
		[/case]
		[case]
		value=two
		[message]
			speaker=Viktor
			message= _ "It's too late! The forces following us have caught up!"
		[/message]
		[/case]
		[case]
		value=three
		[message]
			speaker=Eridith
			message= _ "Oh no! The runes have shut down. We're trapped!"
		[/message]
		[/case]
		[case]
		value=four
		[message]
			speaker=Eridith
			message= _ "Oh no! The runes have shut down. We're trapped!"
		[/message]
		[/case]
		[else]
		[message]
			speaker=Prince Sven
			message= _ "The mist is starting to choke us! We're doomed!"
		[/message]
		[/else]
	[/switch]
	[music]
		name=null.ogg
		immediate=yes
	[/music]
	[sound]
		name=defeat.ogg
	[/sound]
	[endlevel]
		result=defeat
	[/endlevel]
[/event]
[/scenario]

